document.addEventListener("DOMContentLoaded",(()=>{"use strict";let e,t,r,a=document.querySelector(".js-draggable");const o=a.querySelectorAll('[name="order[]"]');if(a)e=a.getAttribute("data-url"),t=a.getAttribute("data-direction"),r=a.getAttribute("data-nested");else if(Joomla.getOptions("draggable-list")){const o=Joomla.getOptions("draggable-list");a=document.querySelector(o.id),a.classList.contains("js-draggable")||a.classList.add("js-draggable"),({url:e}=o),({direction:t}=o),r=o.nested}if(a){for(let e=0,t=o.length;t>e;e+=1)o[e].setAttribute("data-order",e+1);document.addEventListener("touchstart",(()=>{}),!1);const l=(e,t)=>{let r,a;const o=[],l=[].slice.call(e.querySelectorAll('[name="order[]"]')),d=[].slice.call(e.querySelectorAll('[name="cid[]"]'));for("desc"===t&&(l.reverse(),d.reverse()),r=0,a=l.length;a>r;r+=1)l[r].value=r+1,o.push(`order[]=${encodeURIComponent(l[r].value)}`),o.push(`cid[]=${encodeURIComponent(d[r].value)}`);return o};dragula([a],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:(e,t,a,o)=>r&&null!==o?o.getAttribute("data-draggable-group")&&o.getAttribute("data-draggable-group")===e.getAttribute("data-draggable-group"):null===o||o&&"tr"===o.tagName.toLowerCase()}).on("drag",(()=>{})).on("cloned",(()=>{document.querySelector(".gu-mirror").classList.add("table")})).on("drop",(()=>{if(e){const r=document.querySelector('[name="task"]');r&&r.setAttribute("name","some__Temporary__Name__");const o={url:e,method:"POST",data:l(a,t).join("&"),perform:!0};Joomla.request(o),r&&r.setAttribute("name","task")}})).on("dragend",(()=>{const e=a.querySelectorAll('[name="order[]"]');for(let t=0,r=e.length;r>t;t+=1)e[t].setAttribute("data-order",t+1)}))}}));