function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}Joomla=window.Joomla||{},function(t){"use strict";t.resetFilters=function(t){var e=t.form;if(!e)throw new Error("Element must be inside a form!");var i=[].slice.call(e.elements);if(i.length){var o=[];i.forEach((function(e){"task"===e.getAttribute("name")||"boxchecked"===e.getAttribute("name")||"1"===e.value&&/^[0-9A-F]{32}$/i.test(e.name)||e===t||o.push(e)})),o.forEach((function(t){t.value=""})),e.submit()}};var e=function(){function e(i,o){_classCallCheck(this,e);this.element=i,this.options=t.extend({formSelector:".js-stools-form",searchFieldSelector:".js-stools-field-search",clearBtnSelector:".js-stools-btn-clear",mainContainerSelector:".js-stools",searchBtnSelector:".js-stools-btn-search",filterBtnSelector:".js-stools-btn-filter",filterContainerSelector:".js-stools-container-filters",filtersHidden:!0,listBtnSelector:".js-stools-btn-list",listContainerSelector:".js-stools-container-list",listHidden:!0,orderColumnSelector:".js-stools-column-order",orderBtnSelector:".js-stools-btn-order",orderFieldSelector:".js-stools-field-order",orderFieldName:"list[fullordering]",limitFieldSelector:".js-stools-field-limit",defaultLimit:20,activeOrder:null,activeDirection:"ASC",clearListOptions:!1},o),this.theForm=document.querySelector(this.options.formSelector),this.filterButton=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.filterBtnSelector)),this.filterContainer=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.filterContainerSelector))?document.querySelector("".concat(this.options.formSelector," ").concat(this.options.filterContainerSelector)):"",this.filtersHidden=this.options.filtersHidden,this.listButton=document.querySelector(this.options.listBtnSelector),this.listContainer=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.listContainerSelector)),this.listHidden=this.options.listHidden,this.mainContainer=document.querySelector(this.options.mainContainerSelector),this.searchButton=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.searchBtnSelector)),this.searchField=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.searchFieldSelector)),this.searchString=null,this.clearButton=document.querySelector(this.options.clearBtnSelector),this.orderCols=Array.prototype.slice.call(document.querySelectorAll("".concat(this.options.formSelector," ").concat(this.options.orderColumnSelector))),this.orderField=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.orderFieldSelector)),this.limitField=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.limitFieldSelector)),this.activeColumn=null,this.activeDirection=this.options.activeDirection,this.activeOrder=this.options.activeOrder,this.activeLimit=null,this.clearListOptions=this.options.clearListOptions;var s=this;this.searchString=this.searchField.value,this.showFilters=this.showFilters.bind(this),this.hideFilters=this.hideFilters.bind(this),this.showList=this.showList.bind(this),this.hideList=this.hideList.bind(this),this.toggleFilters=this.toggleFilters.bind(this),this.toggleList=this.toggleList.bind(this),this.checkFilter=this.checkFilter.bind(this),this.clear=this.clear.bind(this),this.createOrderField=this.createOrderField.bind(this),this.checkActiveStatus=this.checkActiveStatus.bind(this),this.activeFilter=this.activeFilter.bind(this),this.deactiveFilter=this.deactiveFilter.bind(this),this.getFilterFields=this.getFilterFields.bind(this),this.getListFields=this.getListFields.bind(this),this.hideContainer=this.hideContainer.bind(this),this.showContainer=this.showContainer.bind(this),this.toggleContainer=this.toggleContainer.bind(this),this.toggleDirection=this.toggleDirection.bind(this),this.updateFieldValue=this.updateFieldValue.bind(this),this.findOption=this.findOption.bind(this),this.filterContainer&&this.filterContainer.classList.contains("js-stools-container-filters-visible")?(this.showFilters(),this.showList()):(this.hideFilters(),this.hideList()),this.filterButton&&this.filterButton.addEventListener("click",(function(t){s.toggleFilters(),t.stopPropagation(),t.preventDefault()})),this.listButton&&this.listButton.addEventListener("click",(function(t){s.toggleList(),t.stopPropagation(),t.preventDefault()})),this.getFilterFields()&&this.getFilterFields().forEach((function(t){s.checkFilter(t),t.addEventListener("change",(function(){s.checkFilter(t)}))})),this.clearButton&&this.clearButton.addEventListener("click",s.clear),this.createOrderField(),this.orderCols.forEach((function(t){t.addEventListener("click",(function(t){var e=t.target,i="span"===e.tagName.toLowerCase()?e.parentNode:e,o=i.getAttribute("data-order"),r=i.getAttribute("data-direction"),n="".concat(o," ").concat(r);o.length&&(s.activeColumn=o,n!==s.activeOrder?(s.activeDirection=r,s.activeOrder=n,s.updateFieldValue(s.orderField,n)):s.toggleDirection(),s.theForm.submit())}))})),this.checkActiveStatus(this)}return _createClass(e,[{key:"checkFilter",value:function(t){if("select"===t.tagName.toLowerCase()){var e=t.querySelector("option:checked");e&&(""!==e.value?this.activeFilter(t,this):this.deactiveFilter(t,this))}else""!==t.value?this.activeFilter(t,this):this.deactiveFilter(t,this)}},{key:"clear",value:function(){var t=this;t.searchField&&(t.searchField.value=""),t.getFilterFields()&&t.getFilterFields().forEach((function(e){e.value="",t.checkFilter(e),window.jQuery&&window.jQuery.chosen&&window.jQuery(e).trigger("chosen:updated")})),t.clearListOptions&&(t.getListFields().forEach((function(e){e.value="",t.checkFilter(e),window.jQuery&&window.jQuery.chosen&&window.jQuery(e).trigger("chosen:updated")})),document.querySelector("#list_limit").value=t.options.defaultLimit,window.jQuery&&window.jQuery.chosen&&window.jQuery("#list_limit").trigger("chosen:updated")),t.theForm.submit()}},{key:"updateFilterCount",value:function(t){this.clearButton&&(this.clearButton.disabled=0===t&&!this.searchString.length)}},{key:"checkActiveStatus",value:function(t){var e=this.getFilterFields(),i=0;if(e.forEach((function(e){e.classList.contains("active")&&(i+=1,t.filterButton.classList.remove("btn-secondary"),t.filterButton.classList.add("btn-primary"))})),0===i){var o=document.getElementById("filteredBy");o&&o.parentNode.removeChild(o)}this.clearButton&&(this.clearButton.disabled=0===i&&!this.searchString.length)}},{key:"activeFilter",value:function(t){t.classList.add("active");var e="#".concat(t.getAttribute("id")),i=t.querySelector(e);i&&i.classList.add("active");var o=document.getElementById("filteredBy");if(o){var s="";if("select"===t.tagName.toLowerCase())if(!0===t.multiple){var r=t.querySelectorAll("option:checked"),n=[].slice.call(r).map((function(t){return t.text}));s="".concat(t.labels[0].textContent," - ").concat(n.join())}else s="".concat(t.labels[0].textContent," - ").concat(t.options[t.selectedIndex].text);else s="".concat(t.labels[0].textContent," - ").concat(t.value);o.textContent+=s}}},{key:"deactiveFilter",value:function(t){t.classList.remove("active");var e="#".concat(t.getAttribute("id")),i=t.querySelector(e);i&&i.classList.remove("active")}},{key:"getFilterFields",value:function(){if(this.filterContainer)return Array.prototype.slice.call(this.filterContainer.querySelectorAll("select,input"))}},{key:"getListFields",value:function(){return Array.prototype.slice.call(this.listContainer.querySelectorAll("select"))}},{key:"hideContainer",value:function(t){t&&(t.classList.remove("js-stools-container-filters-visible"),document.body.classList.remove("filters-shown"))}},{key:"showContainer",value:function(t){t.classList.add("js-stools-container-filters-visible"),document.body.classList.add("filters-shown")}},{key:"toggleContainer",value:function(t){t.classList.contains("js-stools-container-filters-visible")?this.hideContainer(t):this.showContainer(t)}},{key:"hideList",value:function(){this.hideContainer(this.filterContainer)}},{key:"showList",value:function(){this.showContainer(this.filterContainer)}},{key:"toggleList",value:function(){this.toggleContainer(this.filterContainer)}},{key:"hideFilters",value:function(){this.hideContainer(this.filterContainer)}},{key:"showFilters",value:function(){this.showContainer(this.filterContainer)}},{key:"toggleFilters",value:function(){this.toggleContainer(this.filterContainer)}},{key:"toggleDirection",value:function(){var t=this,e="ASC";"ASC"===t.activeDirection.toUpperCase()&&(e="DESC"),t.activeDirection=e,t.activeOrder="".concat(t.activeColumn," ").concat(e),t.updateFieldValue(t.orderField,t.activeOrder)}},{key:"createOrderField",value:function(){var t=this,e=this;(this.orderField||(this.orderField=document.createElement("input"),this.orderField.setAttribute("type","hidden"),this.orderField.setAttribute("id","js-stools-field-order"),this.orderField.setAttribute("class","js-stools-field-order"),this.orderField.setAttribute("name",e.options.orderFieldName),this.orderField.setAttribute("value","".concat(e.activeOrder," ").concat(this.activeDirection)),this.theForm.append(this.orderField)),"select"===this.orderField.tagName.toLowerCase())&&([].slice.call(this.orderField.options).forEach((function(i){var o=i.getAttribute("data-order"),s=i.getAttribute("data-name"),r=i.getAttribute("data-direction");if(o&&o.length){o="".concat(o," ").concat(r);var n=e.findOption(e.orderField,o);n.length||((n=document.createElement("option")).text=s,n.value=o,i.classList.contains("active")&&n.setAttribute("selected","selected"),t.orderFieldName.innerHTML+=n)}})),window.jQuery&&window.jQuery.chosen&&window.jQuery(this.orderField).trigger("chosen:updated"));this.activeOrder=this.orderField.value}},{key:"updateFieldValue",value:function(t,e){var i=t.getAttribute("type");if("hidden"===i||"text"===i)t.setAttribute("value",e);else if("select"===t.tagName.toLowerCase()){var o;if([].slice.call(t.options).forEach((function(t){t.value===e&&(o=t)})),o&&o.length)o.setAttribute("selected","selected");else{var s=document.createElement("option");s.text=e,s.value=e,s.setAttribute("selected","selected"),t.appendChild(s)}t.value=e,window.jQuery&&window.jQuery.chosen&&t.trigger("chosen:updated")}}},{key:"findOption",value:function(t,e){for(var i=0,o=t.length;o>i;i++)if(t[i].value===e)return t[i]}}]),e}();document.addEventListener("DOMContentLoaded",(function i(){if(t.getOptions("searchtools")){var o=t.getOptions("searchtools"),s=document.querySelector(o.selector);new e(s,o)}var r=document.getElementById("sorted"),n=document.getElementById("orderedBy");if(r&&r.hasAttribute("data-caption")&&n){var l=r.getAttribute("data-caption");n.textContent+=l}if(r&&r.hasAttribute("data-sort")){var c=r.getAttribute("data-sort");r.parentNode.setAttribute("aria-sort",c)}document.removeEventListener("DOMContentLoaded",i)}))}(Joomla);